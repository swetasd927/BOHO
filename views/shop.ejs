<%- include('./partials/header') %>

<% if(success && success.length > 0){ %>
<div class="fixed top-3 left-1/2 -translate-x-1/2 z-50 p-3 rounded-lg bg-green-500 shadow-lg max-w-md">
  <span class="inline-block text-white text-sm">
    <%= success %>
  </span>
</div>
<% } %>

<div class="w-full min-h-screen flex bg-gray-50">
  <!-- Sidebar -->
  <div class="w-64 bg-white p-6 border-r border-gray-200">
    <h2 class="text-2xl font-bold mb-8">Premium Bag Shop</h2>
    
    <!-- Sort By -->
    <div class="mb-8">
      <h3 class="text-sm font-semibold mb-3">sort by</h3>
      <select class="w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500">
        <option>Popular</option>
        <option>Price: Low to High</option>
        <option>Price: High to Low</option>
        <option>Newest</option>
      </select>
    </div>

    <!-- Categories -->
    <div class="mb-8">
      <div class="space-y-3">
        <div class="flex items-center">
          <input type="checkbox" id="new" class="mr-3 w-4 h-4">
          <label for="new" class="text-sm">New Collection</label>
        </div>
        <div class="flex items-center">
          <input type="checkbox" id="all" class="mr-3 w-4 h-4">
          <label for="all" class="text-sm">All Products</label>
        </div>
        <div class="flex items-center">
          <input type="checkbox" id="discounted" class="mr-3 w-4 h-4">
          <label for="discounted" class="text-sm">Discounted Products</label>
        </div>
      </div>
    </div>

    <!-- Filter By -->
    <div>
      <h3 class="text-sm font-semibold mb-3">Filter by:</h3>
      <div class="space-y-3">
        <div class="flex items-center">
          <input type="checkbox" id="availability" class="mr-3 w-4 h-4">
          <label for="availability" class="text-sm">Availability</label>
        </div>
        <div class="flex items-center">
          <input type="checkbox" id="discount" class="mr-3 w-4 h-4">
          <label for="discount" class="text-sm">Discount</label>
        </div>
      </div>
    </div>
  </div>

  <!-- Products Grid -->
  <div class="flex-1 p-6">
    <% if (products && products.length > 0) { %>
      <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4">
        <% products.forEach(function(product) { %>
        <div class="bg-white rounded-lg overflow-hidden shadow-sm hover:shadow-lg transition-shadow duration-300 cursor-pointer">
          <!-- Product Image -->
          <div class="w-full h-40 flex items-center justify-center" style="background: <%= product.bgcolor || '#fbbf24' %>">
            <% if (product.image && typeof product.image === 'string' && product.image.startsWith('http')) { %>
              <img src="<%= product.image %>" alt="<%= product.name %>" class="w-full h-full object-cover">
            <% } else if (product.image && product.image.data) { %>
              <img src="data:image/jpeg;base64,<%= product.image.data.toString('base64') %>" alt="<%= product.name %>" class="w-full h-full object-cover">
            <% } else if (product.image && Buffer.isBuffer(product.image)) { %>
              <img src="data:image/jpeg;base64,<%= product.image.toString('base64') %>" alt="<%= product.name %>" class="w-full h-full object-cover">
            <% } else { %>
              <svg class="w-16 h-16 text-white opacity-60" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"></path>
              </svg>
            <% } %>
          </div>
          
          <!-- Product Info -->
          <div class="p-2.5" style="background: <%= product.panelcolor || '#ef4444' %>">
            <div class="flex items-center justify-between">
              <div style="color: <%= product.textcolor || '#ffffff' %>">
                <h4 class="font-medium mb-0.5 text-sm"><%= product.name %></h4>
                <div class="flex items-center gap-2">
                  <p class="font-semibold text-sm">â‚¹ <%= product.price %></p>
                  <% if (product.discount > 0) { %>
                    <span class="text-xs bg-white/20 px-2 py-0.5 rounded-full"><%= product.discount %>% OFF</span>
                  <% } %>
                </div>
              </div>
              <button class="bg-white rounded-full w-7 h-7 flex items-center justify-center hover:bg-gray-100 transition-colors duration-200">
                <svg class="w-3.5 h-3.5" style="color: <%= product.panelcolor || '#ef4444' %>" fill="currentColor" viewBox="0 0 20 20">
                  <path d="M10 3.22l-.61-.6a5.5 5.5 0 0 0-7.78 7.77L10 18.78l8.39-8.4a5.5 5.5 0 0 0-7.78-7.77l-.61.61z"/>
                </svg>
              </button>
            </div>
          </div>
        </div>
        <% }); %>
      </div>
    <% } else { %>
      <!-- Empty State -->
      <div class="flex flex-col items-center justify-center h-96">
        <svg class="w-24 h-24 text-gray-300 mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"></path>
        </svg>
        <h3 class="text-2xl font-semibold text-gray-700 mb-2">No Products Available</h3>
        <p class="text-gray-500 mb-4">Check back soon for amazing products!</p>
      </div>
    <% } %>
  </div>
</div>

<%- include('./partials/footer') %>